
<!DOCTYPE html>
<html lang="pt-br" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  <base href="http://tableless.com.br/">
  <title>Tableless</title>
  <link rel="canonical" href="http://tableless.com.br/lidando-bem-com-os-bloqueadores-de-pop-up/">
  <link href="" rel="alternate" type="application/rss+xml" title="Tableless" />
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css">
  
</head>
<body>


  <header id="tb-header">
    <a href="http://tableless.com.br/" class="tb-logo"><img src="images/logo.svg"></a>

    

    <nav id="tb-menu">
      <ul>

        
          
              
            <li>
              <a href="/categories/html">
                  
                  HTML
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/css/">
                  
                  CSS
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/javascript/">
                  
                  JavaScript
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/back-end/">
                  
                  Back-end
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/wordpress/">
                  
                  WordPress
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/acessibilidade/">
                  
                  Acessibilidade
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/design/">
                  
                  Design
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/t%C3%A9cnicas-e-pr%C3%A1ticas/">
                  
                  Na prática
              </a>
          
            </li>
          

      </ul>
    </nav>

  </header>

  <header class="tb-post-header">
    <h1 class="tb-hero-title"><a href="/lidando-bem-com-os-bloqueadores-de-pop-up/">Lidando bem com os bloqueadores de pop-up</a></h1>
  <p class="tb-hero-p">
    
    Todo mundo que já experimentou ama bloqueadores de pop-ups. Navegando há anos com Opera e Konqueror e usando Firefox para acessar o Gmail, ainda me assusto quando preciso navegar no IE, seja num cybercafé ou na máquina de um amigo. Como é que as pessoas podem conviver com aquilo? Pop-ups são muito chatos, e se você não acha é porque ainda não experimentou viver sem eles tempo o suficiente.
    
  </p>
      <span class="tb-author">por <a href="/author/elcio-ferreira">Elcio Ferreira</a></span>


  </header>


<section class="tb-post">

  <section class="tb-post-content">
    <article class="tb-post-article">
      

<p>Todo mundo que já experimentou ama bloqueadores de pop-ups. Navegando há anos com <a href="http://www.opera.com/" title="A melhor experiência de internet">Opera</a> e <a href="http://www.konqueror.org/" title="Konqueror - Web Browser, File Manager - and more!">Konqueror</a> e usando <a href="http://www.mozilla.org/products/firefox/" title="Firefox - The Browser, Reloaded">Firefox</a> para acessar o <a href="http://gmail.google.com" title="Email com gosto de Google">Gmail</a>, ainda me assusto quando preciso navegar no IE, seja num cybercafé ou na máquina de um amigo. Como é que as pessoas podem conviver com aquilo? Pop-ups são muito chatos, e se você não acha é porque ainda não experimentou viver sem eles tempo o suficiente.</p>

<p>Por outro lado, o advento dos bloqueadores de pop-up trouxe alguns desafios bastante específicos para o desenvolvedor. Por exemplo, o desafio de fazer sites compatíveis com qualquer navegador quando é obrigado a usar ferramentas de terceiros. É o caso, por exemplo, de alguns sistemas de pagamento nacionais, ferramentas essenciais para o desenvolvimento de qualquer e-commerce brasileiro. O fato é que muitos desses sistemas exigem dos seus usuários a exibição de um pop-up, seja em uma tela de pagamento ou, o que é mais comum, no recibo.</p>

<p>Para complicar, esses sistemas geralmente são submetidos a complexos e burocráticos processos de homologação, onde geralmente a pessoa que vai aprovar seu sistema usa Internet Explorer para Windows e não vai estar muito interessado em ouvir seus argumentos a respeito da inacessibilidade dos pop-ups. Vamos então criar uma solução para que o usuário de navegadores sem bloqueador de pop-ups possam ver normalmente seus pop-ups enquanto os que possuem bloqueador sejam servidos com um confortável link para o endereço do pop-up. Além disso, vamos fazer que aqueles que escolheram o gerenciamenteo inteligente de pop-ups possam ver um pop-up ao clicar no link, mantendo o layout do recibo como foi planejado pelo sistema de pagamento, e o que escolheu bloquear todos os pop-ups possa ver o conteúdo na mesma janela.</p>

<h3 id="primeiro-passo">Primeiro passo:</h3>

<p>Telefonar e escrever para pessoal do sistema de pagamentos, avisando que pop-ups são uma solução ruim. Demonstre sua indignação pelo fato de o sistema deles precisar de uma ferramenta tão estúpida. De quebra, aproveite para perguntar como fazer o site deles, o módulo administrativo, ou o que mais eles tenham feito para que você e seu cliente acessem funcionar em seu navegador. Pergunte porque o manual fala sobre Internet Explorer e Netscape 4, mas não fala do Safari ou do Firefox. Apresente dessa maneira o Opera e o Mozilla. Se muitos de nós fizermos isso, eles vão ter que começar a considerar esses navegadores ao criar seus sistemas.</p>

<h3 id="segundo-passo">Segundo passo:</h3>

<p>Entender os fatos básicos. Agora que você já ajudou a tornar a web um lugar melhor, vamos resolver o problema imediato do nosso cliente. Primeiro vamos ver como criar um link de pop-up que seja acessível a quem não quer ou não pode exibir pop-ups. Links para pop-ups geralmente são criados assim:</p>

<pre>&lt;a href="javascript:void(open('http://www.atipico.com.br','nova','width=800,height=600'))"&gt;Atípico&lt;/a&gt;</pre>

<p>O problema é que quem não tem javascript em seu navegador ou bloqueou todos os pop-ups não pode acessar o link. Muita gente por aí tem usado assim:</p>

<pre>&lt;a href="http://www.atipico.com.br" onclick="window.open(this.href,'nova','width=800,height=600');return false;"&gt;Atípico&lt;/a&gt;</pre>

<p>Assim, o link passa a ser um link HTML comum. Para quem tem javascript disponível, o evento onclick vai abrir o popup e o <strong>return false</strong> ao final vai cancelar o click, fazendo com que a página seja aberta apenas no pop-up, e não na janela atual. Apesar da beleza e da simplicidade, este código tem dois problemas. O primeiro é que o Internet Explorer 5.0, em algumas situações, não lida muito bem com comandos separados por ponto-e-vírgula em atributos HTML. O segundo, mais sério, é que navegadores como Konqueror e Firefox não interrompem um script ao bloquear um pop-up. Então, se o Konqueror estiver configurado para bloquear todos os pop-ups, o pop-up não vai aparecer, e o <strong>return false</strong> vai ser executado, fazendo com que o link também não seja carregado na janela atual.</p>

<p>De fato, o código acima era muito usado antes do advento dos bloqueadores de pop-up, para manter o site acessível en navegadores sem javascript. Ele funciona muito bem se não houver javascript disponível, mas falha em alguns navegadores se houver javascript e o bloqueador de pop-ups estiver habilitado.</p>

<p>Para entender mais de perto a problemática vamos verificar como os navegadores se comportam ao bloquear um popup. Para isso vamos usar o seguinte código:</p>

<pre>&lt;script&gt;
    alert("passo 1")
    window.open("http://www.atipico.com.br","nova","width=800,height=600")
    alert("passo 2")
&lt;/script&gt;
&lt;script&gt;
    alert("passo 3")
&lt;/script&gt;</pre>

<p>Fazendo o teste com este script você pode notar como os navegadores se comportam de maneira diferente ao bloquear um pop-up. Testei no Opera 7.52, no Firefox 0.8 e no Konqueror 3.2.2, todos em Linux. O Mozilla e o Konqueror exibem os três alerts. Ou seja, o pop-up é bloqueado mas o script segue sua execução normal. No Opera são exibidos os alerts 1 e 3. O Opera, portanto, interrompe a execução de um script ao bloquear um pop-up, mas executa normalmente outros scripts na mesma página. O Internet Explorer com a <a href="http://toolbar.google.com/" title="Google Toolbar">Google Toolbar</a> se comportou de maneira idêntica ao Mozilla e ao Konqueror.</p>

<h3 id="terceiro-passo">Terceiro passo:</h3>

<p>Vamos manter nosso pop-up automático, e inserir um link para abrir pop-up que poderá ser usado por quem usa bloqueadores (ou mesmo por alguém que tenha fechado o pop-up por engano):</p>

<pre>&lt;script&gt;
    pagina="http://www.atipico.com.br"

    function abrir(){
        newWindow=window.open(pagina,"nova","width=800,height=600")
        if(newWindow)return false
    }

    abrir()
&lt;/script&gt;
&lt;a href='http://www.atipico.com.br' onclick='return abrir()'&gt;Abrir&lt;/a&gt;</pre>

<p>Aqui criamos uma função, abrir, que abre o popup. Em seguida a executamos. Se não houver bloqueadores o pop-up será exibido automaticamente neste passo. Exibimos então um link &#8220;Abrir&#8221; que executa novamente a função quando clicado. Aqui está toda a mágica, o <strong>onclick</strong> do link contém <strong>return abrir()</strong>, ou seja, o evento será tratado de acordo com o retorno da função. O click somente será cancelado se a função retornar false.</p>

<p>Agora note que a função tem duas linhas. Na primeira abrimos a nova janela (pop-up) e armazenamos o resultado na variável <strong>newWindow</strong>. Na segunda linha testamos o valor de newWindow, se existir retornamos false. Assim, acompanhe nosso programa em três situações diferentes: primeiro, se não houver bloqueadores de pop-ups ou se o bloqueador estiver configurado em <strong>smart policy</strong>, ou seja, permitir os pop-ups requisitados por você. Neste caso, a primeira linha da função abre a janela e armazena o objeto na variável newWindow. A segunda linha testa o valor de newWindow, que existe, e retorna false, cancelando o click. Neste caso o usuário verá o pop-up e nada acontece com a janela original, perfeito. O segundo caso é o de bloqueadores de pop-ups que não permitem pop-up algum, mas não interrompem a execução do script. Neste caso, o pop-up não será aberto. Ao chegar à segunda linha da função, new Window é testada, e não existe. A função não retornará valor (na verdade retornará undefined, mas isso é outro assunto). O click não será cancelado e o usuário verá a página solicitada na janela original. A terceira situação é o caso dos bloqueadores de pop-up que interrompem a execução do script. Nestes o script sequer chegará à segunda linha da função, o javascript será interrompido e o evento não será cancelado, uma vez que o script sequer chegou a retornar algum valor. O resultado será idêntico ao segundo caso.</p>

<p>Há ainda uma quarta situação, a dos navegadores que não possuem javascript habilitado. Neste caso o link vai se comportar como um link normal, sem nenhum problema para o usuário (embora eu duvide que alguém sem javascript consiga usar qualquer sistema de pagamento eletrônico disponível no Brasil.)</p>

<h3 id="quarto-passo">Quarto passo:</h3>

<p>Pra quê um quarto passo? O código anterior já funciona muito bem, resolvendo nosso problema. Bom talvez você seja curioso o suficiente para querer complicar um pouco as coisas. A questão agora é: como exibir conteúdo de acordo com o status do pop-up. Isto é, por exemplo, se não houver bloqueador de pop-up não exibir o link &#8220;Abrir&#8221;, uma vez que o usuário verá o pop-up automaticamente. Pois bem, vamos lá:</p>

<pre>&lt;script&gt;
    pagina="http://www.atipico.com.br"

    abriu=false

    function abrir(){
        newWindow=window.open(pagina,"nova","width=800,height=600")
        if(newWindow){
            abriu=true
            return false
        }
    }

    abrir()

&lt;/script&gt;
&lt;script&gt;
if(!abriu)document.write("&lt;a href='http://www.atipico.com.br' onclick='return abrir()'&gt;Abrir&lt;/a&gt;")
&lt;/script&gt;</pre>

<p>Agora usamos uma variável, <strong>abriu</strong>, para guardar o status do pop-up. Começamos o script atribuindo false a esta variável. Depois, dentro do if que testa o pop-up, setamos seu valor para true. Se o pop-up for aberto o valor de abriu será true, caso contrário será mantido o false original.</p>

<p>No segundo bloco script testamos o valor de abriu. Se o pop-up não foi aberto, escrevemos no documento o link para abrí-lo. Colocamos esta linha em um segundo bloco script para que seja executada mesmo que o bloqueador interrompa o primeiro script ao cancelar o pop-up.</p>

<p>O script já faz o que propusemos, exibe o link apenas se o pop-up não for aberto automaticamente. Mas agora ele falha em navegadores sem suporte a javascript. Iso é fácil de resolver, basta colocar, depois dos scripts:</p>

<pre>&lt;noscript&gt;
    &lt;a href="http://www.atipico.com.br"&gt;Abrir&lt;/a&gt;
&lt;/noscript&gt;</pre>

<h3 id="palavras-finais">Palavras finais:</h3>

<p>Como você viu, lidar com bloqueadores de pop-up é tarefa trivial, e você pode oferecer conteúdo ao seu usuário no formato que ele escolheu ver, pop-ups para quem não se importa com eles, ou mesmo para quem os deseja, e links comuns para quem escolheu não ver pop-ups. Claro, continuamos achando que pop-ups não são uma boa ferramenta, mas como você não pode trabalhar sempre sozinho, isto pode lhe ser útil ao lidar com código de terceiros, como os citados sistemas de e-commerce.</p>

<p>O código nesse artigo foi escrito apenas para estudo. É claro, quando for para valer, você deve escrever código melhor que o meu. Seus links precisam ter um atributo <strong>title</strong> que descreva bem seu destino, e &#8220;Abrir&#8221; não é um bom texto para se colocar em um link. Você sabe também que, neste último exemplo, depois de <strong>if(!abriu)</strong> você pode fazer o que quiser, e também deve saber que não é bom escrever scripts assim, no meio do seu HTML, e que document.write não é uma boa maneira de se exibir conteúdo. Esperamos que estas idéias lhe sejam úteis. Se você desenvolver algo útil com isso <a href="mailto:elciof+artigopopup@gmail.com" title="Email para o Elcio">conte pra gente</a>.</p>

    </article>

<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = '';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
  </section>


  <aside class="tb-aside">
    Banner
  </aside>

</section>


<footer id="tb-footer">
    <div class="tb-container">
    <ul class="tb-social-links">
        <li><a href="http://facebook.com/tablelessbr">Facebook</a></li>
        <li><a href="http://twitter.com/tableless">Twitter</a></li>
        <li><a href="http://tableless.com.br/feed">RSS</a></li>
        <li><a href="http://medium.com/tableless">Medium</a></li>
    </ul>
    <nav class="tb-footer-nav">
        <a href="">Contato</a>
        <a href="">Anuncie</a>
        <a href="">Seja um Autor</a>
        <a href="">Fazemos código front-end</a>
    </nav>

    <p class="tb-for-community">
        Escrito pela e para a comunidade web brasileira. <a href="">Ajude</a>.
    </p>
    </div>
</footer>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>


<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
<script>
$(document).ready(function() {
  $('pre').each(function(i, block) {
    hljs.highlightBlock(block);
  });
})</script>


</body>
</html>

