
<!DOCTYPE html>
<html lang="pt-br" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  <base href="https://tableless.github.io/hugo-public/">
  <title>Tableless</title>
  <link rel="canonical" href="https://tableless.github.io/hugo-public/codigo-limpo-escreva-seu-codigo-hoje-sem-esquecer-da-manutencao-de-amanha/">
  <link href="" rel="alternate" type="application/rss+xml" title="Tableless" />
  <link rel="stylesheet" href="https://tableless.github.io/hugo-public/css/style.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css">

</head>
<body>


  <header id="tb-header">
    <a href="https://tableless.github.io/hugo-public/" class="tb-logo"><img src="images/logo.svg"></a>

    

    <nav id="tb-menu">
      <ul>

        
          
              
            <li>
              <a href="/hugo-public/categories/html">
                  
                  HTML
              </a>
          
            </li>
          
              
            <li>
              <a href="/hugo-public/categories/css/">
                  
                  CSS
              </a>
          
            </li>
          
              
            <li>
              <a href="/hugo-public/categories/javascript/">
                  
                  JavaScript
              </a>
          
            </li>
          
              
            <li>
              <a href="/hugo-public/categories/back-end/">
                  
                  Back-end
              </a>
          
            </li>
          
              
            <li>
              <a href="/hugo-public/categories/wordpress/">
                  
                  WordPress
              </a>
          
            </li>
          
              
            <li>
              <a href="/hugo-public/categories/acessibilidade/">
                  
                  Acessibilidade
              </a>
          
            </li>
          
              
            <li>
              <a href="/hugo-public/categories/design/">
                  
                  Design
              </a>
          
            </li>
          
              
            <li>
              <a href="/hugo-public/categories/t%C3%A9cnicas-e-pr%C3%A1ticas/">
                  
                  Na prática
              </a>
          
            </li>
          

      </ul>
    </nav>

  </header>

  <header class="tb-post-header">
    <h1 class="tb-hero-title"><a href="/hugo-public/codigo-limpo-escreva-seu-codigo-hoje-sem-esquecer-da-manutencao-de-amanha/">Código Limpo – Escreva seu código hoje sem esquecer da manutenção de amanhã</a></h1>
  <p class="tb-hero-p">
    
    Seu código é legível e fácil de dar manutenção? Veja neste post porque escrever código limpo é importante e como equilibrar isso com os prazos dos projetos.
    
  </p>
      <span class="tb-author">por <a href="/hugo-public/author/tableless">tableless</a></span>


  </header>


<section class="tb-post">

  <section class="tb-post-content">
    <article class="tb-post-article">
      

<p>Você provavelmente já precisou entender o código de outra pessoa. Seja para realizar uma alteração, corrigir um <em>bug</em> ou até mesmo para procurar um comportamento específico.</p>

<p>Talvez você até tenha feito isso no seu próprio código!</p>

<p>Agora pense por alguns segundos: O código foi <strong>fácil</strong> de entender?</p>

<p>Você, <strong>só pela leitura</strong>, conseguiu identificar o método exato que precisava alterar?</p>

<p>Se a resposta for positiva: ótimo! O programador fez a sua parte e conseguiu deixar o código limpo (ou pelo menos fez um código simples o suficiente para ser entendido).</p>

<p>Mas se a resposta for &#8220;mais ou menos&#8221;, ou &#8220;nem um pouco&#8221;, é aí que mora o problema.</p>

<p>E essa é a explicação para o título deste post.</p>

<h2 id="mas-por-que-isso-acontece">Mas por que isso acontece?</h2>

<p>Quando aprendemos a programar, estamos mais preocupados em aprender a lógica de programação e fazer as coisas funcionarem do que com a estrutura e leitura do código. E isso é totalmente normal, afinal, estamos iniciando.</p>

<p>Porém, na minha opinião, o problema começa quando evoluímos em nossa carreira (começamos a trabalhar em projetos maiores e ter mais responsabilidades) e <strong>não evoluímos o nosso código na mesma medida</strong>.</p>

<p>Aí começam a aparecer os famosos &#8220;códigos espaguete&#8221; ou mesmo aquele monte de variáveis que não ajudam em nada a entender o código.</p>

<p>Leia o código abaixo e responda:</p>

<ul>
<li>Consegue identificar qual método você precisa chamar primeiro pra cadastrar um novo cliente?</li>
<li>Percebe como os métodos estão sem ordem nenhuma e um chama o outro internamente, formando um &#8220;espaguete&#8221;?</li>
</ul>

<pre class="lang-php">class CadastroCliente
{
    public function enviarEmail()
    {
        $mailer = new Mailer();
        $mailer-&gt;send();
    } 
    
    public function gerarSenha()
    {
        // codigo para gerar senha
        
        return $senha;
    }
    
    public function atualizar($cliente)
    {
        $model = new ClienteModel();
        $model-&gt;confirmar($cliente);
    }

    public function criar($cliente)
    {
        $senha = $this-&gt;gerarSenha();
        
        $model = new ClienteModel();
        $model-&gt;add($cliente, $senha);

        $this-&gt;enviarEmail();
    }
    
    public function confirmarCadastro($cliente)
    {
        $this-&gt;enviarEmail();
        $this-&gt;atualizar($cliente);
    }
}
</pre>

<p>O problema dessa evolução tardia é que somente depois de muito tempo o desenvolvedor vai descobrir que poderia ter feito melhor. Note que começar escrevendo códigos confusos não é o problema, mas sim o tempo necessário para entender que essa evolução é importante.</p>

<p>E então, ao perceber que o código não está dos melhores, o desenvolvedor pode escolher entre:</p>

<p>1 &#8211; Deixar pra lá, por que o seu código sempre funciona</p>

<p>2 &#8211; Começar a melhorar o seu código pensando na qualidade do software</p>

<h2 id="código-funcionando-next">Código funcionando! Next!</h2>

<p>A sensação de ver nosso código funcionando é ótima! Quem não gosta?</p>

<p>Só que muita gente para por aí, nem lembra que por trás daquele comportamento existem classes, métodos, variáveis, etc.</p>

<p>Mas será que esse código está legível? As classes possuem responsabilidades definidas? Os métodos estão coerentes?</p>

<p>Pois é, existem vários pontos que precisamos estar atentos para que nosso código seja limpo.</p>

<p>Mas apesar de parecer muito complicado, na verdade podemos começar da forma mais simples possível: comece aos poucos e vá sempre buscando deixá-lo mais legível. Não tem como você fazer o melhor código de primeira.</p>

<p>Para exemplificar essa transformação de um código difícil de ser lido em um código limpo, veja o trecho abaixo:</p>

<pre class="lang-php">class Carrinho
{
    private $vl;
    private $prods;

    public function adic($prods)
    {
        foreach ($prods as $prod) {
            if ($prod-&gt;getCat() == 'P') {
                $vl = $prod-&gt;getVl() * 0.75;
                $this-&gt;vl += $vl;
                $this-&gt;prods[] = $prod;
            } elseif ($prod-&gt;getCat() == 'B') {
                $vl = 0;
                $this-&gt;vl += $vl;
                $this-&gt;prods[] = $prod;
            } elseif ($prod-&gt;getCat() == '') {
                $vl = $prod-&gt;getVl();
                $this-&gt;vl += $vl;
                $this-&gt;prods[] = $prod;
            }
        }
    } 
}
</pre>

<p>Você consegue identificar o que são aqueles valores (P e B) ou até mesmo entender rapidamente o que o método faz?</p>

<p>Vamos deixá-lo um pouco mais claro:</p>

<pre class="lang-php">class Carrinho
{
    private $valorTotal;
    private $produtos;

    public function adicionarProduto($produtos)
    {
        foreach ($produtos as $produto) {
            if ($produto-&gt;getCategoria() == 'PROMOCAO') {
                $valor = $produto-&gt;getValor() * 0.75;
                $this-&gt;valorTotal += $valor;
                $this-&gt;produtos[] = $produto;
            } elseif ($produto-&gt;getCategoria() == 'BRINDE') {
                $valor = 0;
                $this-&gt;valorTotal += $valor;
                $this-&gt;produtos[] = $produto;
            } elseif ($produto-&gt;getCategoria() == '') {
                $valor = $produto-&gt;getValor();
                $this-&gt;valorTotal += $valor;
                $this-&gt;produtos[] = $produto;
            }
        }
    } 
}
</pre>

<p>Agora já dá pra entender mais rápido o que o método faz: adicionar um produto no carrinho e acrescenta o valor do produto no valor total.</p>

<p>Mas dá pra melhorar ainda mais:</p>

<pre class="lang-php">class Carrinho
{
    private $valorTotal;
    private $produtos;

    public function adicionarProduto($produtos)
    {   
        foreach ($produtos as $produto) {
            $valor = $produto-&gt;getValor();
            
            if ($produto-&gt;getCategoria() == 'PROMOCAO') {
                $valor = $produto-&gt;getValor() * 0.75;
            } elseif ($produto-&gt;getCategoria() == 'BRINDE') {
                $valor = 0;
            }

            $this-&gt;valorTotal += $valor;
            $this-&gt;produtos[] = $produto;
        }
    } 
}
</pre>

<p>Notou que as linhas que atualizam o valor total e os produtos internos da classe se repetiam a cada <code>if</code>?</p>

<p>Já que se repetem, podemos tirar de dentro dos <code>ifs</code>, pois ele sempre será executado independente da condição.</p>

<p>Além disso, podemos inicializar a variável <code>$valor</code> com o valor do produto, e de acordo com a categoria do produto atualizamos essa variável. Assim conseguimos eliminar a utilização de um <code>if</code> desnecessário verificando se o produto não tem categoria.</p>

<p>Agora o toque final:</p>

<pre class="lang-php">class Carrinho
{
    private $valorTotal;
    private $produtos;

    public function adicionarProduto($produtos = [])
    {   
        foreach ($produtos as $produto) {
            $this-&gt;valorTotal += $this-&gt;calcularValorProduto($produto);
            $this-&gt;produtos[] = $produto;
        }
    }

    private function calcularValorProduto(Produto $produto)
    {
        if ($produto-&gt;getCategoria() == Produto::CATEGORIA_BRINDE) {
            return 0;
        }

        if ($produto-&gt;getCategoria() == Produto::CATEGORIA_PROMOCAO) {
            return $produto-&gt;getValor() * 0.75;
        }

        return $produto-&gt;getValor();
    }
}
</pre>

<p>Pronto, o código agora ficou mais simples e os métodos com uma únicaresponsabilidade definida.</p>

<p>Veja as alterações realizadas:</p>

<ul>
<li>Agora o cálculo do valor fica em um método privado da classe, para não ficar tudo no método <code>adicionarProduto</code></li>
<li>Foi adicionado um <em>Type Hint</em> no método <code>calcularValorProduto</code> para garantir que a variável <code>$produto</code> seja um objeto da classe <code>Produto</code></li>
<li>No método de cálculo, trocamos o <code>elseif</code> por dois <code>ifs</code> separados: isso facilita a separação por blocos de código, e consequentemente a leitura</li>
<li>Ainda no método de cálculo, ao invés de inicializar a variável <code>$valor</code> com o valor do produto, foram adicionados <code>returns</code> em cada condição: isso possibilita o método retornar o valor mais rapidamente, já que não é mais necessário executar o método inteiro</li>
<li>Foram trocados os valores fixos das categorias por constantes da classe <code>Produto</code></li>
</ul>

<p>Objetivo alcançado: conseguimos deixar o código mais descritivo, separar os métodos e manter o mesmo funcionamento. E o mais importante: tudo isso foi feito de forma incremental.</p>

<p>Talvez depois de um tempo outras melhorias possam sem aplicadas, mas o código já melhorou o suficiente por enquanto.</p>

<p>Aliás, isso é o que todos nós deveríamos fazer: ao invés de você tentar abraçar o mundo e deixar seu código perfeito, tente deixá-lo o mais simples possível (e que atenda os requisitos, claro), e vá aperfeiçoando com o tempo.</p>

<p>Até por que provavelmente você terá que realizar alterações nele depois, e aí você pode &#8220;aparar as arestas&#8221; e ir deixando cada vez melhor.</p>

<p>Só não deixe seu código para trás sem revisá-lo antes, isso com certeza vai deixar alterações futuras muito mais custosas de serem feitas.</p>

<h2 id="certo-mas-e-se-o-prazo-estiver-apertado">Certo, mas e se o prazo estiver apertado?</h2>

<p>No ciclo de desenvolvimento de software, sempre existem os casos em que o prazo é bem apertado.</p>

<p>Apesar de entender que precisamos de tempo suficiente para sempre testar nosso código e escrevê-lo bem, algumas vezes realmente não há saída: precisamos entregar e ponto.</p>

<p>Nestes casos, precisamos sempre colocar na balança se vale a pena gastar mais tempo para projetar melhor a arquitetura, testar todas as nossas classes e revisar o código.</p>

<p>O que não pode acontecer é utilizar estes argumentos como desculpas para não entregar a solução.</p>

<p>Se há espaço para refinar o código e testá-lo, então eu recomendo que faça. Você vai agradecer um dia por ter feito isso.</p>

<p>Caso a entrega seja de muita urgência, desenvolva de uma forma que conseguirá entregar no prazo. Mas também não use isso como desculpa para escrever qualquer código!</p>

<p>Fique atento a boas práticas durante o desenvolvimento acelerado, seja nomeando suas variáveis e métodos melhor, quebrando os comportamento em classes menores, etc.</p>

<p>Observe uma alteração pequena usando o exemplo anterior, mas que vai ajudar a tornar o código muito mais simples:</p>

<pre class="lang-php">class Carrinho
{
    private $vl;
    private $prods;

    // Adiciona um produto no carrinho
    // Passar um array de produtos
    public function adic($prods)
    {
        foreach ($prods as $prod) {
            // Categoria do produto -&gt; P = Promocao
            if ($prod-&gt;getCat() == 'P') {
                $vl = $prod-&gt;getVl() * 0.75;
                $this-&gt;vl += $vl;
                $this-&gt;prods[] = $prod;
                
            // Categoria do produto -&gt; B = Brinde
            } elseif ($prod-&gt;getCat() == 'B') {
                $vl = 0;
                $this-&gt;vl += $vl;
                $this-&gt;prods[] = $prod;
            
            // Sem categoria, utilizar o valor do produto
            } elseif ($prod-&gt;getCat() == '') {
                $vl = $prod-&gt;getVl();
                $this-&gt;vl += $vl;
                $this-&gt;prods[] = $prod;
            }
        }
    } 
}
</pre>

<p>Você acha que esses comentários são importantes para o código? E se um dia algum outro desenvolvedor alterar as siglas das categorias, você acha que os comentários serão atualizados?</p>

<p>E se ao invés de adicionar comentários, você deixasse explícito o que cada variável e método faz por meio do nome deles?</p>

<pre class="lang-php">class Carrinho
{
    private $valorTotal;
    private $produtos;

    public function adicionarProduto($produtos)
    {
        foreach ($produtos as $produto) {
            if ($produto-&gt;getCategoria() == 'PROMOCAO') {
                $valor = $produto-&gt;getValor() * 0.75;
                $this-&gt;valorTotal += $valor;
                $this-&gt;produtos[] = $produto;
            } elseif ($produto-&gt;getCategoria() == 'BRINDE') {
                $valor = 0;
                $this-&gt;valorTotal += $valor;
                $this-&gt;produtos[] = $produto;
            } elseif ($produto-&gt;getCategoria() == '') {
                $valor = $produto-&gt;getValor();
                $this-&gt;valorTotal += $valor;
                $this-&gt;produtos[] = $produto;
            }
        }
    } 
}
</pre>

<p>Veja que todos os comentários foram removidos. Ao invés de escrever o comportamento da classe nos comentários, os métodos e variáveis já dizem o que fazem e para o que servem.</p>

<p>Por isso, por mais que o prazo seja apertado, sempre há um jeito de deixar o código mais limpo.</p>

<p>Só não deixe de entregar o seu trabalho no prazo tentando fazer o código perfeito, isso talvez não valha tanto a pena no final.</p>

<h2 id="conclusão">Conclusão</h2>

<p>Você provavelmente percebeu o valor de escrever código limpo.</p>

<p>Isso no longo prazo faz uma enorme diferença, e é uma responsabilidade que todos nós programadores precisamos estar cientes. Não basta apenas escrever código, você tem que sempre pensar que outras pessoas também irão trabalhar nele.</p>

<p>Por isso sempre procure aperfeiçoar suas habilidades não só para aprender outras linguagens, mas para melhorar o seu código em si, independente da linguagem que você trabalhe.</p>

<p>E se você quer aprender como escrever código limpo, existem alguns livros que irão explicar os principais conceitos e técnicas.</p>

<p>Um deles que eu recomendo é o <a href="https://www.amazon.com.br/C%C3%B3digo-Limpo-Habilidades-Pr%C3%A1ticas-Softwar/dp/8576082675/ref=sr_1_1?ie=UTF8&qid=1467162877&sr=8-1&keywords=c%C3%B3digo+limpo" target="_blank">Código Limpo, do Robert C. Martin (Uncle Bob)</a>.</p>

<p>Além disso, existem algumas práticas para auxiliar no projeto de classes e na implementação dos métodos, como <em>SOLID</em> e <em>Object Calisthenics</em>.</p>

<p>Por fim, esta é a minha visão sobre qualidade de código, se você tiver outro ponto de vista ou algum complemento, escreva nos comentários!</p>

    </article>

<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = '';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
  </section>


  <aside class="tb-aside">
    Banner
  </aside>

</section>


<footer id="tb-footer">
    <div class="tb-container">
    <ul class="tb-social-links">
        <li><a href="http://facebook.com/tablelessbr">Facebook</a></li>
        <li><a href="http://twitter.com/tableless">Twitter</a></li>
        <li><a href="http://tableless.com.br/feed">RSS</a></li>
        <li><a href="http://medium.com/tableless">Medium</a></li>
    </ul>
    <nav class="tb-footer-nav">
        <a href="">Contato</a>
        <a href="">Anuncie</a>
        <a href="">Seja um Autor</a>
        <a href="">Fazemos código front-end</a>
    </nav>

    <p class="tb-for-community">
        Escrito pela e para a comunidade web brasileira. <a href="">Ajude</a>.
    </p>
    </div>
</footer>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>


<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
<script>
$(document).ready(function() {
  $('pre').each(function(i, block) {
    hljs.highlightBlock(block);
  });
})</script>


</body>
</html>

