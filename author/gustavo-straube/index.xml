<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Gustavo Straube on Tableless</title>
    <link>http://tableless.com.br/author/gustavo-straube/index.xml</link>
    <description>Recent content in Gustavo Straube on Tableless</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>pt-br</language>
    <atom:link href="http://tableless.com.br/author/gustavo-straube/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Assinatura de newsletter com PHP integrada Ã  API do Mailchimp</title>
      <link>http://tableless.com.br/assinatura-de-newsletter-com-php-integrada-a-api-do-mailchimp/</link>
      <pubDate>Tue, 10 Feb 2015 00:00:00 +0000</pubDate>
      
      <guid>http://tableless.com.br/assinatura-de-newsletter-com-php-integrada-a-api-do-mailchimp/</guid>
      <description>

&lt;p&gt;O Mailchimp tem uma &lt;a href=&#34;https://apidocs.mailchimp.com/&#34; target=&#34;_blank&#34;&gt;API bem completa&lt;/a&gt;. Arrisco dizer que Ã© possÃ­vel fazer uma interface com muitas das funcionalidades de gerenciamento de listas, envios, etc usando a API â€” fica a dica para quem quiser desenvolver uma aplicaÃ§Ã£o explorando alguma lacuna que o painel do Mailchimp deixa a desejar.&lt;/p&gt;

&lt;p&gt;Eu sabia da existÃªncia da API faz algum tempo, mas usava uma funÃ§Ã£o simples de exportaÃ§Ã£o de CSV em alguns projetos. Mas dependendo da frequÃªncia de disparo das newsletters, exportar um arquivo e importar no Mailchimp comeÃ§a a ser um tanto trabalhoso. EntÃ£o esse Ã© o meu caso de uso: um formulÃ¡rio de newsletter.&lt;/p&gt;

&lt;p&gt;AÃ­ alguÃ©m diz: â€œMas vocÃª estÃ¡ reinventando a roda! O Mailchimp te dÃ¡ um formulÃ¡rio pronto, vocÃª nÃ£o precisa integrar com a API, basta gerar o cÃ³digo, copiar e colar.â€ E eu respondo: â€œSim, existe essa possibilidade, mas e se alÃ©m de enviar para o Mailchimp vocÃª precisa gravar na sua base de dados esses e-mails? E se a opÃ§Ã£o de assinatura da newsletter Ã© um checkbox (opt-in) em um formulÃ¡rio de cadastro?â€ Acho que assim temos uma ideia melhor de quando usar a API para a captaÃ§Ã£o de e-mails.&lt;/p&gt;

&lt;p&gt;EntÃ£o, vamos botar a mÃ£o no cÃ³digo:&lt;/p&gt;

&lt;h2 id=&#34;1-chave-da-api&#34;&gt;1. Chave da API&lt;/h2&gt;

&lt;p&gt;Mas, ops! Antes de ir para a programaÃ§Ã£o, toda integraÃ§Ã£o com a API precisa de uma chave para autenticaÃ§Ã£o. Para gerar essa chave vocÃª precisa entrar na sua conta do Mailcimp (se vocÃª nÃ£o tem uma conta, criar uma nova Ã© bem simples e nÃ£o tem custo), e seguir o seguinte caminho:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;no menu do usuÃ¡rio (canto direito superior), ir em &lt;strong&gt;â€œAccountâ€&lt;/strong&gt;;&lt;/li&gt;
&lt;li&gt;na aba &lt;strong&gt;â€œExtrasâ€&lt;/strong&gt;, selecionar &lt;strong&gt;â€œAPI keysâ€&lt;/strong&gt;;&lt;/li&gt;
&lt;li&gt;nessa tela vocÃª pode criar uma chave (&lt;strong&gt;â€œCreate API keyâ€&lt;/strong&gt;).&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;A chave gerada Ã© sua forma de autenticaÃ§Ã£o na API, entÃ£o deve ser mantida em seguranÃ§a.&lt;/p&gt;

&lt;h2 id=&#34;2-instalaÃ§Ã£o&#34;&gt;2 InstalaÃ§Ã£o&lt;/h2&gt;

&lt;p&gt;Existe um &lt;a href=&#34;https://bitbucket.org/mailchimp/mailchimp-api-php&#34; target=&#34;_blank&#34;&gt;SDK PHP oficial do Mailchimp&lt;/a&gt;. VocÃª pode instalar &lt;a href=&#34;http://tableless.com.br/composer-para-iniciantes/&#34; target=&#34;_blank&#34;&gt;usando o Composer&lt;/a&gt;, incluindo a seguinte dependÃªncia no seu arquivo &lt;strong&gt;composer.json&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&#34;mailchimp/mailchimp&#34;: &#34;2.0.*&#34;&lt;/pre&gt;

&lt;p&gt;E executando o &lt;strong&gt;composer install&lt;/strong&gt; (ou &lt;strong&gt;update&lt;/strong&gt; se for um projeto jÃ¡ existente).&lt;/p&gt;

&lt;p&gt;Mas se vocÃª nÃ£o estÃ¡ usando o Composer (estÃ¡ desenvolvendo um tema ou plugin de WordPress, por exemplo) pode baixar o &lt;a href=&#34;https://bitbucket.org/mailchimp/mailchimp-api-php/get/master.zip&#34; target=&#34;_blank&#34;&gt;pacote com o SDK&lt;/a&gt;. Caso opte por esse tipo de instalaÃ§Ã£o, provavelmente vai ser necessÃ¡rio incluir no seu cÃ³digo um &lt;strong&gt;require&lt;/strong&gt; para a classe principal: &lt;strong&gt;src/Mailchimp.php&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&#34;3-integrando&#34;&gt;3 Integrando&lt;/h2&gt;

&lt;p&gt;Vamos comeÃ§ar usando um formulÃ¡rio HTML simples, com apenas dois inputs: e-mail e cidade. Estou optando por usar esses dados, porque quero mostrar como usar campos personalizados com a API. O arquivo &lt;strong&gt;newsletter.php&lt;/strong&gt; deve ser algo assim:&lt;/p&gt;

&lt;pre&gt;&amp;lt;form action=&#34;mailchimp.php&#34; method=&#34;post&#34;&amp;gt;
  &amp;lt;h1&amp;gt;Newsletter&amp;lt;/h1&amp;gt;
  &amp;lt;label&amp;gt;E-mail&amp;lt;/label&amp;gt;
  &amp;lt;input type=&#34;email&#34; name=&#34;email&#34;&amp;gt;&amp;lt;br&amp;gt;
  &amp;lt;label&amp;gt;Cidade&amp;lt;/label&amp;gt;
  &amp;lt;input type=&#34;text&#34; name=&#34;city&#34;&amp;gt;&amp;lt;br&amp;gt;
  &amp;lt;button type=&#34;submit&#34;&amp;gt;Assinar!&amp;lt;/button&amp;gt;
&amp;lt;/form&amp;gt;&lt;/pre&gt;

&lt;p&gt;Obs.: Como o foco Ã© o uso da API, nÃ£o estou me preocupando com a estÃ©tica do formulÃ¡rio, ok? ğŸ˜‰&lt;/p&gt;

&lt;p&gt;Seguindo vamos para o arquivo &lt;strong&gt;mailchimp.php&lt;/strong&gt;, que receberÃ¡ os dados enviados pele formulÃ¡rio:&lt;/p&gt;

&lt;p&gt;Primeiro comeÃ§amos definindo algumas configuraÃ§Ãµes, usando constantes:&lt;/p&gt;

&lt;pre&gt;define(&#39;MAILCHIMP_API_KEY&#39;, Â &#39;&#39;); // Sua chave da API
define(&#39;MAILCHIMP_LIST_ID&#39;, Â &#39;&#39;); // O ID da sua lista
define(&#39;MAILCHIMP_CITY_TAG&#39;, &#39;&#39;); // A tag do campo personalizado que usaremos&lt;/pre&gt;

&lt;p&gt;Tem duas informaÃ§Ãµes novas aqui: o &lt;strong&gt;ID da lista&lt;/strong&gt; e a &lt;strong&gt;tag do campo&lt;/strong&gt; personalizado. Conseguimos esses dados no painel do Mailchimp, assim:&lt;/p&gt;

&lt;h3 id=&#34;id-da-lista&#34;&gt;ID da lista&lt;/h3&gt;

&lt;p&gt;Na lista para qual vocÃª quer adicionar as assinaturas (se vocÃª nÃ£o tem nenhuma lista na sua conta, precisarÃ¡ criar uma antes de continuar), no menu &lt;strong&gt;â€œSettingsâ€&lt;/strong&gt; vÃ¡ atÃ© &lt;strong&gt;â€œList name and defaultsâ€&lt;/strong&gt;. Nessa tela, do lado direto, existe uma pequena sessÃ£o com o tÃ­tulo &lt;strong&gt;â€œList IDâ€&lt;/strong&gt;, dali vocÃª vai copiar um cÃ³digo, tipicamente formado por letras e nÃºmeros.&lt;/p&gt;

&lt;h3 id=&#34;tag-do-campo&#34;&gt;Tag do campo&lt;/h3&gt;

&lt;p&gt;Ainda na lista e novamente no menu &lt;strong&gt;â€œSettingsâ€&lt;/strong&gt; vocÃª vai atÃ© o link &lt;strong&gt;â€œList fields and *|MERGE|* tagsâ€&lt;/strong&gt;. Ali vocÃª vai copiar a tag correspondente ao campo usado no form, que no nosso exemplo Ã© o &lt;strong&gt;â€œCidadeâ€&lt;/strong&gt;. O que vocÃª precisa Ã© o valor que estÃ¡ no input, algo parecido com &lt;strong&gt;â€œMMERGE3â€&lt;/strong&gt; â€” esse nÃºmero no final muda de um campo para outro.&lt;/p&gt;

&lt;p&gt;Caso vocÃª ainda nÃ£o tenha criado nenhum campo personalizado, vocÃª pode criar um agora.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Continuando com o cÃ³digo&amp;#8230;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Para usar um nome mais claro no cÃ³digo (e evitar usar as globais do PHP), vou repassar o conteÃºdo recebido do form para uma nova variÃ¡vel:&lt;/p&gt;

&lt;pre&gt;$form = $_POST;&lt;/pre&gt;

&lt;p&gt;Na sequÃªncia vou fazer uma validaÃ§Ã£o bem bÃ¡sica dos dados, apenas verificando se os campos foram preenchidos. Provavelmente vocÃª vai querer fazer algo mais eficaz, como verificar se o formato do e-mail Ã© vÃ¡lido ou se o nome da cidade tem um mÃ­nimo de caracteres, por exemplo.&lt;/p&gt;

&lt;pre&gt;if (!empty($form[&#39;email&#39;]) &amp;&amp; !empty($form[&#39;city&#39;])) {
  $mailchimp = new Mailchimp(MAILCHIMP_API_KEY);
  $lists = new Mailchimp_Lists($mailchimp);
  $email = [
    &#39;email&#39; =&amp;gt; $form[&#39;email&#39;],
  ];
  $merge = [
    MAILCHIMP_CITY_TAG =&amp;gt; $form[&#39;city&#39;],
  ];
  $lists-&amp;gt;subscribe(
    MAILCHIMP_LIST_ID, // ID da lista
    $email, Â Â Â Â Â Â Â Â Â Â Â // O e-mail do assinante
    $merge, Â Â Â Â Â Â Â Â Â Â Â // Campos personalizados
    &#39;html&#39;, Â Â Â Â Â Â Â Â Â Â Â // Tipo de e-mail recebido
    false Â Â Â Â Â Â Â Â Â Â Â Â Â // Confirmar assinatura por e-mail (opt-in duplo)?
  );
  echo &#39;Newsletter assinada!&#39;;
} else {
  echo &#39;Por favor preencha os campos. &amp;lt;a href=&#34;newsletter.php&#34;&amp;gt;Voltar&amp;lt;/a&amp;gt;&#39;;
}&lt;/pre&gt;

&lt;p&gt;Se vocÃª usou um e-mail que ainda nÃ£o estÃ¡ na lista para testar o formulÃ¡rio, vai ver que ele funciona a primeira vez, mas nos envios seguintes o PHP indica uma exceÃ§Ã£o. Se o teste foi feito com um e-mail jÃ¡ cadastrado, nem o primeiro envio funcionou.&lt;/p&gt;

&lt;p&gt;Isso acontece porque o SDK do Mailchimp usa exceÃ§Ãµes para indicar qualquer coisa que impeÃ§a a chamada Ã  API de ser executada com sucesso, incluindo a tentativa de assinatura com um e-mail jÃ¡ cadastrado. Para tratar esses casos, vamos fazer a seguinte alteraÃ§Ã£o no cÃ³digo que estÃ¡ dentro do &lt;strong&gt;if&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;try {
    $mailchimp = â€¦

    ...

    echo &#39;Newsletter assinada!&#39;;
  } catch (Mailchimp_List_AlreadySubscribed $e) {
    echo &#39;VocÃª jÃ¡ assinou a newsletter.&#39;;
  } catch (Mailchimp_Email_AlreadySubscribed $e) {
    echo &#39;VocÃª jÃ¡ assinou a newsletter.&#39;;
  } catch (Mailchimp_Email_NotExists $e) {
    echo &#39;O e-mail informado nÃ£o existe.&#39;;
  } catch (Mailchimp_Invalid_Email $e) {
    echo &#39;O e-mail informado Ã© invÃ¡lido.&#39;;
  } catch (Mailchimp_List_InvalidImport $e) {
    echo &#39;Dados invÃ¡lidos, provavelmente seu e-mail.&#39;;
  } catch (Exception $e) {
    echo $e-&amp;gt;getMessage(); // NÃ£o mostre isso para o usuÃ¡rio
  }&lt;/pre&gt;

&lt;p&gt;Dessa forma conseguimos tratar algumas exceÃ§Ãµes mais comuns que o SDK pode lanÃ§ar e devolver um feedback para o usuÃ¡rio, assim ele Ã© capaz de corrigir as informaÃ§Ãµes e tentar novamente.&lt;/p&gt;

&lt;p&gt;Para os outros casos, fazemos um tratamento genÃ©rico apenas exibindo a mensagem da exceÃ§Ã£o. Isso Ã© o suficiente para um exemplo como esse aqui, mas nÃ£o Ã© o ideal para um cÃ³digo real que vai para produÃ§Ã£o, porque pode expÃ´r bugs e informaÃ§Ãµes sensÃ­veis da sua aplicaÃ§Ã£o. EntÃ£o recomendo fazer um tratamento mais adequado, como gravar em um arquivo de log ou &lt;a href=&#34;http://tableless.com.br/rastreando-excecoes-no-php-com-o-airbrake/&#34; target=&#34;_blank&#34;&gt;usar um rastreador de bugs&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Agora quando vocÃª submeter o formulÃ¡rio com um e-mail jÃ¡ cadastrado, verÃ¡ a mensagem: &lt;strong&gt;â€œVocÃª jÃ¡ assinou a newsletter.â€&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&#34;conclusÃ£o&#34;&gt;ConclusÃ£o&lt;/h2&gt;

&lt;p&gt;Essa integraÃ§Ã£o Ã© bem bÃ¡sica, mas dÃ¡ uma ideia do que Ã© possÃ­vel fazer com a API do Mailchimp. Como falei no inÃ­cio, vocÃª pode ir muito mais alÃ©m do que um formulÃ¡rio de captaÃ§Ã£o de e-mails. E mesmo em se tratando da assinatura de listas, vocÃª pode refinar o cÃ³digo que apresentei e integrar em um formulÃ¡rio de cadastro do seu site, e atÃ© adicionar novos campos.&lt;/p&gt;

&lt;p&gt;Caso tenha alguma dÃºvida ou encontre algum erro, fique a vontade para usar os comentÃ¡rios.&lt;/p&gt;

&lt;p&gt;Ah! O cÃ³digo completo estÃ¡ disponÃ­vel no GitHub: &lt;a href=&#34;https://github.com/straube/mailchimp-sample-form&#34; target=&#34;_blank&#34;&gt;&lt;a href=&#34;https://github.com/straube/mailchimp-sample-form&#34;&gt;https://github.com/straube/mailchimp-sample-form&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Rastreando exceÃ§Ãµes no PHP com o Airbrake</title>
      <link>http://tableless.com.br/rastreando-excecoes-no-php-com-o-airbrake/</link>
      <pubDate>Mon, 15 Sep 2014 00:00:00 +0000</pubDate>
      
      <guid>http://tableless.com.br/rastreando-excecoes-no-php-com-o-airbrake/</guid>
      <description>

&lt;p&gt;IdentificarÂ erros, e suas causas, em uma aplicaÃ§Ã£o web pode seÂ tornar umaÂ tarefa complicada. Ter algumas ferramentas Ã  mÃ£o pode simplificar bastante essa missÃ£o.&lt;/p&gt;

&lt;p&gt;Algo que provavelmenteÂ ajuda a rastrearÂ uma falha sÃ£o os logs da aplicaÃ§Ã£o ou do servidor onde ela estÃ¡ sendo executada, mas nÃ£o Ã© fÃ¡cil encontrar algo especÃ­fico, especialmente se o volume de registros Ã© grande.&lt;/p&gt;

&lt;p&gt;Outra situaÃ§Ã£o desagradÃ¡vel Ã© quando os erros acontecem em situaÃ§Ãµes especÃ­ficas, difÃ­ceisÂ de reproduzir.&lt;/p&gt;

&lt;p&gt;Ainda pode haver um cenÃ¡rio em que asÂ exceÃ§Ãµes acontecem com os usuÃ¡rios, mas nunca sÃ£o reportadas aos desenvolvedores. E como verificar logs proativamente Ã© algo muito improvÃ¡vel, esses erros ficam no esquecimento.&lt;/p&gt;

&lt;p&gt;PensandoÂ nesses obstÃ¡culos, o &lt;a title=&#34;Airbrake&#34; href=&#34;https://airbrake.io/&#34; target=&#34;_blank&#34;&gt;Airbrake&lt;/a&gt; pode facilitar muito a vida de quem desenvolve e mantÃ©m software para web. Conheci ele usando o &lt;a title=&#34;Codebase&#34; href=&#34;https://www.codebasehq.com/&#34; target=&#34;_blank&#34;&gt;Codebase&lt;/a&gt; (tambÃ©m uma excelente ferramenta, porÃ©mÂ para gerenciamento de projetos), que tem integraÃ§Ã£o na parte de tickets/rastreamento de bugs.&lt;/p&gt;

&lt;h2 id=&#34;1-qual-Ã©-a-mÃ¡gica&#34;&gt;1. Qual Ã© a mÃ¡gica?&lt;/h2&gt;

&lt;p&gt;O princÃ­pio do funcionamento do Airbrake Ã© bem simples: toda vez que uma exceÃ§Ã£o ou erro sÃ£o gerados, as informaÃ§Ãµes sobre a requisiÃ§Ã£o, sessÃ£o do usuÃ¡rio e ambiente sÃ£o enviadas para o servidor atravÃ©s da API. A partir dessas informaÃ§Ãµes, sÃ£o gerados relatÃ³rios e Ã© possÃ­vel realizar buscas no histÃ³rico. Uma grande vantagem Ã© que os erros sÃ£o agrupados, entÃ£o se um mesmo acontece com frequÃªncia nÃ£o â€œsujarÃ¡â€ o log.&lt;/p&gt;

&lt;p&gt;A cada novo erro na sua aplicaÃ§Ã£o, uma notificaÃ§Ã£o Ã© enviada por e-mail.&lt;/p&gt;

&lt;h2 id=&#34;2-configurando-o-serviÃ§o&#34;&gt;2. Configurando o serviÃ§o&lt;/h2&gt;

&lt;p&gt;Para iniciar, vocÃª deve ter uma conta no &lt;a title=&#34;Airbrake&#34; href=&#34;https://airbrake.io/&#34; target=&#34;_blank&#34;&gt;Airbrake&lt;/a&gt;. NÃ£o hÃ¡ plano gratuito, mas existe um perÃ­odo de testes de 30 dias.&lt;/p&gt;

&lt;p&gt;Ainda existe a opÃ§Ã£o de usar uma alternativa open source compatÃ­vel com a mesma API, que Ã© o &lt;a title=&#34;Errbit&#34; href=&#34;https://github.com/errbit/errbit&#34; target=&#34;_blank&#34;&gt;Errbit&lt;/a&gt;, mas nesse caso vocÃª precisa instalar o serviÃ§o em um servidor prÃ³prio. Caso opte pelo Errbit, as instruÃ§Ãµes de instalaÃ§Ã£o estÃ£o disponÃ­veis no repositÃ³rio do GitHub: &lt;a title=&#34;RepositÃ³rio do Errbit no GitHub&#34; href=&#34;https://github.com/errbit/errbit&#34; target=&#34;_blank&#34;&gt;&lt;a href=&#34;https://github.com/errbit/errbit&#34;&gt;https://github.com/errbit/errbit&lt;/a&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;3-instalaÃ§Ã£o&#34;&gt;3. InstalaÃ§Ã£o&lt;/h2&gt;

&lt;p&gt;Como minha linguagem do dia-a-dia Ã© PHP, vou seguir com as instruÃ§Ãµes focando nela, mas a lÃ³gica de instalaÃ§Ã£oÂ nÃ£o muda muito de uma linguagem para outra. Caso precise, no site do Airbrake existem &lt;a title=&#34;IntegraÃ§Ã£o do Airbrake com linguagens&#34; href=&#34;https://airbrake.io/languages&#34; target=&#34;_blank&#34;&gt;instruÃ§Ãµes para outras linguagens&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Se vocÃª jÃ¡ estiver usando o &lt;a href=&#34;https://getcomposer.org/&#34; target=&#34;_blank&#34;&gt;Composer&lt;/a&gt;, basta adicionar a dependÃªncia no arquivo &lt;strong&gt;composer.json&lt;/strong&gt; do seu projeto:&lt;/p&gt;

&lt;pre&gt;{ 
    &#34;require&#34;: {
        &#34;dbtlr/php-airbrake&#34;: &#34;dev-master&#34;
    }
}&lt;/pre&gt;

&lt;p&gt;Se nÃ£o usa o Composer, essa Ã© uma Ã³tima oportunidade para comeÃ§ar. O Andre Cardoso escreveu sobre ele aqui no Tableless: &lt;a title=&#34;Composer para iniciantes&#34; href=&#34;http://tableless.com.br/composer-para-iniciantes/&#34; target=&#34;_blank&#34;&gt;Composer para iniciantes&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Caso nÃ£o esteja usando um framework, provavelmente precisarÃ¡ adicionar a chamada ao class loader do Composer:&lt;/p&gt;

&lt;pre&gt;require_once &#39;vendor/autoload.php&#39;;&lt;/pre&gt;

&lt;h2 id=&#34;4-integraÃ§Ã£o&#34;&gt;4. IntegraÃ§Ã£o&lt;/h2&gt;

&lt;p&gt;Agora vocÃª precisa fazer com que as exceÃ§Ãµes e erros do PHP sejam enviadas para a o Airbrake, para isso vocÃª tem pelo menos dois caminhos possÃ­veis de acordo com a estrutura do seu projeto:&lt;/p&gt;

&lt;h3 id=&#34;sem-framework-ou-com-um-framework-que-nÃ£o-tem-manipulaÃ§Ã£o-de-exceÃ§Ãµes&#34;&gt;Sem framework ou com um framework que nÃ£o tem manipulaÃ§Ã£o de exceÃ§Ãµes&lt;/h3&gt;

&lt;p&gt;Nesse caso, basta usar a manipulaÃ§Ã£o de exceÃ§Ãµes da prÃ³pria API, assim:&lt;/p&gt;

&lt;pre&gt;Airbrake\EventHandler::start(&#39;API_KEYâ€™);&lt;/pre&gt;

&lt;p&gt;Lembrando de substituir o &lt;strong&gt;API_KEY&lt;/strong&gt; pela sua prÃ³pria chave da API do Airbrake.&lt;/p&gt;

&lt;p&gt;Adicionando essa chamada logo no inÃ­cio do seu script ou em um dos pontos de entrada da sua aplicaÃ§Ã£o as funÃ§Ãµes set_exception_handler e set_error_handler, do PHP, sÃ£o chamadas.&lt;/p&gt;

&lt;h3 id=&#34;com-framework-que-tem-manipulaÃ§Ã£o-de-exceÃ§Ãµes&#34;&gt;Com framework que tem manipulaÃ§Ã£o de exceÃ§Ãµes&lt;/h3&gt;

&lt;p&gt;Para registrar a API, basta usar o seguinte trecho de cÃ³digo junto ao manipulador de exceÃ§Ãµes do seu framework:&lt;/p&gt;

&lt;pre&gt;$config = new Airbrake\Configuration(&#39;API_KEY&#39;);
$client = new Airbrake\Client($config);
$client-&amp;gt;notifyOnException($exception);&lt;/pre&gt;

&lt;p&gt;Para facilitar, para alguns, vou dar o exemplo em dois frameworks que tenho usado:&lt;/p&gt;

&lt;h4 id=&#34;com-laravel&#34;&gt;Com Laravel&lt;/h4&gt;

&lt;p&gt;Edite o arquivo &lt;strong&gt;app/start/global.php&lt;/strong&gt;, da seguinte maneira:&lt;/p&gt;

&lt;pre&gt;App::error(function (Exception $exception, $code)
{
    Log::error($exception);

    // Airbrake
    $config = new Airbrake\Configuration(&#39;API_KEY&#39;);
    $client = new Airbrake\Client($config);
    $client-&amp;gt;notifyOnException($exception);

});&lt;/pre&gt;

&lt;h4 id=&#34;com-slim-framework&#34;&gt;Com Slim Framework&lt;/h4&gt;

&lt;p&gt;Edite o arquivo &lt;strong&gt;public/index.php&lt;/strong&gt;, e adicione o seguinte trecho depois de ter instanciado a aplicaÃ§Ã£o:&lt;/p&gt;

&lt;pre&gt;$app-&amp;gt;error(function (\Exception $e) use ($app) {
    $app-&amp;gt;getLog()-&amp;gt;error($e);

    // Airbrake
    $config = new Airbrake\Configuration(&#39;API_KEY&#39;);
    $client = new Airbrake\Client($config);
    $client-&amp;gt;notifyOnException($e);

});&lt;/pre&gt;

&lt;h2 id=&#34;5-um-pequeno-exemplo-funcional&#34;&gt;5. Um pequeno exemplo funcional&lt;/h2&gt;

&lt;p&gt;Caso vocÃª queira fazer um teste rÃ¡pido, pode usar o seguinte script e executÃ¡-lo (depois de ter instalado a dependÃªncia com Composer).&lt;/p&gt;

&lt;pre&gt;&amp;lt;?php
require_once &#39;vendor/autoload.php&#39;;
Airbrake\EventHandler::start(&#39;API_KEY&#39;);

throw new Exception(&#39;Testando o Airbrake&#39;);&lt;/pre&gt;

&lt;p&gt;A cada execuÃ§Ã£o desse script, um novo registro de exceÃ§Ã£o deve ser gravado na sua conta no Airbrake.&lt;/p&gt;

&lt;h2 id=&#34;conclusÃ£o&#34;&gt;ConclusÃ£o&lt;/h2&gt;

&lt;p&gt;O Airbrake nÃ£o Ã© a Ãºnica opÃ§Ã£o disponÃ­vel para gerenciar e rastrear as exceÃ§Ãµes da sua aplicaÃ§Ã£o (apenas para citar mais uma opÃ§Ã£o, tenho usado o &lt;a title=&#34;Sentry&#34; href=&#34;https://www.getsentry.com/&#34; target=&#34;_blank&#34;&gt;Sentry&lt;/a&gt; com sucesso em pelo menos um projeto), mas pode ser um ponto de partida interessante para que vocÃª tenha uma visÃ£o diferente, e mais prÃ¡tica, sobre os erros do seu cÃ³digo.&lt;/p&gt;

&lt;p&gt;Caso vocÃª opte por usar o Errbit, talvez precise de algumas configuraÃ§Ãµes mais avanÃ§adas (como determinar o host ou resource do serviÃ§o, por exemplo), entÃ£o a documentaÃ§Ã£o oficial da bilbioteca para PHP pode te ajudar: &lt;a title=&#34;OpÃ§Ãµes de configuraÃ§Ãµes do PHP Airbrake&#34; href=&#34;https://github.com/dbtlr/php-airbrake#configuration-options&#34; target=&#34;_blank&#34;&gt;&lt;a href=&#34;https://github.com/dbtlr/php-airbrake#configuration-options&#34;&gt;https://github.com/dbtlr/php-airbrake#configuration-options&lt;/a&gt;&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>PHP na linha de comando</title>
      <link>http://tableless.com.br/php-na-linha-de-comando/</link>
      <pubDate>Thu, 24 Jul 2014 00:00:00 +0000</pubDate>
      
      <guid>http://tableless.com.br/php-na-linha-de-comando/</guid>
      <description>

&lt;p&gt;Quem conhece um pouco de alguma linguagem de programaÃ§Ã£o, acaba se acostumando a escrever trechos de cÃ³digo para automatizar tarefas simples ou resolver problemas. Para aqueles mais Ã­ntimos do PHP, se torna habitual escrever aplicaÃ§Ãµes com uma interface simples em HTML, mas com isso deixamos de aproveitar algumas vantagens da linha de comando em conjunto com o nosso script para resolver essas questÃµes triviais (ou nem tanto). TambÃ©m existe benefÃ­cio de nÃ£o depender de um servidor web e um navegador.&lt;/p&gt;

&lt;h2 id=&#34;1-hello-terminal&#34;&gt;1. Hello terminal!&lt;/h2&gt;

&lt;p&gt;Para dar os primeiros passos na execuÃ§Ã£o de scripts a partir do interpretador Ã© interessante comeÃ§ar entendendo como funciona a chamada. EntÃ£o, que tal um â€œHello terminal!â€? Segue o cÃ³digo do nosso primeiro script:&lt;/p&gt;

&lt;pre&gt;&amp;lt;?php
echo &#34;Hello terminal!\n&#34;;&lt;/pre&gt;

&lt;p&gt;A partir da linha de comando, no diretÃ³rio onde vocÃª salvou o seu script, execute (considerando que vocÃª salvou o arquivo como &lt;strong&gt;script.php&lt;/strong&gt;):&lt;/p&gt;

&lt;pre&gt;$ php script.php
Hello terminal!&lt;/pre&gt;

&lt;p&gt;No Windows, vocÃª deverÃ¡ usar o executÃ¡vel do PHP â€” &lt;strong&gt;php.exe script.php&lt;/strong&gt; â€”, mas tenha certeza de que ele estÃ¡ no PATH do sistema.&lt;/p&gt;

&lt;p&gt;Isso deverÃ¡ imprimir a frase â€œ&lt;strong&gt;Hello terminal!&lt;/strong&gt;â€ na saÃ­da padrÃ£o do terminal, como mostrado acima. VocÃª vai ver que se nÃ£o incluir a quebra de linha no final da string (\n), o seu prompt vai ficar na mesma linha que a saÃ­da do script. Isso nÃ£o prejudica a execucÃ£o do script e nem dos prÃ³ximos comandos, mas pode dificultar a leitura do resultado.&lt;/p&gt;

&lt;h2 id=&#34;2-usando-parÃ¢metros&#34;&gt;2. Usando parÃ¢metros&lt;/h2&gt;

&lt;p&gt;Quando usamos o navegador para executar um script PHP e precisamos passar algum parÃ¢metro para ele, incluÃ­mos uma query no final da URL, por exemplo: &lt;strong&gt;?param1=abc&amp;amp;param2=123&lt;/strong&gt;. Usando a linha de comando Ã© possÃ­vel fazer algo semelhante, passando argumentos na chamada do interpretador, logo em seguida ao nome do script, assim:&lt;/p&gt;

&lt;pre&gt;$ php script.php abc 123&lt;/pre&gt;

&lt;p&gt;Nesse exemplo estamos passando dois argumentos: â€œ&lt;strong&gt;abc&lt;/strong&gt;â€ e â€œ&lt;strong&gt;123&lt;/strong&gt;â€. O seu script pode lidar com esses dados atravÃ©s das variÃ¡veis &lt;strong&gt;$argc&lt;/strong&gt; e &lt;strong&gt;$argv&lt;/strong&gt;. A primeira contÃ©m um nÃºmero inteiro com a quantidade de argumentos passados para o interpretador. AtenÃ§Ã£o: o nome do script Ã© o primeiro parÃ¢metro, entÃ£o &lt;strong&gt;$argc&lt;/strong&gt; sempre vai ser no mÃ­nimo 1, no nosso exemplo ele teria o valor 3. A segunda variÃ¡vel contÃ©m um array com os valores dos argumentos. Assim como acontece para a &lt;strong&gt;$argc&lt;/strong&gt;, o primeiro valor Ã© o nome do script.&lt;/p&gt;

&lt;p&gt;Se imprimirmos, usando a funÃ§Ã£o &lt;strong&gt;var_dump&lt;/strong&gt;, o conteÃºdo das variÃ¡veis &lt;strong&gt;$argc&lt;/strong&gt; e &lt;strong&gt;$argv&lt;/strong&gt;, do Ãºltimo exemplo, terÃ­amos:&lt;/p&gt;

&lt;pre&gt;int(3)
array(3) {
  [0]=&amp;gt;
  string(10) &#34;script.php&#34;
  [1]=&amp;gt;
  string(3) &#34;abc&#34;
  [2]=&amp;gt;
  string(3) &#34;123&#34;
}&lt;/pre&gt;

&lt;p&gt;VocÃª vai notar que &lt;strong&gt;$argc&lt;/strong&gt; sempre carrega o mesmo valor que o resultado da chamada &lt;strong&gt;count($argv)&lt;/strong&gt;, em todo caso &lt;strong&gt;$argc&lt;/strong&gt; Ã© o padrÃ£o usado e Ã© alguns milisegundos mais rÃ¡pido por jÃ¡ estar na memÃ³ria (se isso fizer alguma diferenÃ§a na performance do seu script).&lt;/p&gt;

&lt;p&gt;Sabendo disso, como exemplo, podemos escrever um utilitÃ¡rio simples para ajudar em redaÃ§Ãµes: listar as palavras de um texto em ordem alfabÃ©tica seguidas de sua posiÃ§Ã£o no texto, assim podemos verificar como as palavras se repetem no texto e ajustar o vocabulÃ¡rio, se for o caso. Vamos lÃ¡!&lt;/p&gt;

&lt;p&gt;Esperamos que o nome do arquivo (para simplificar vamos usar um TXT simples) seja passado como argumento para o script.&lt;/p&gt;

&lt;pre&gt;&amp;lt;?php

/*
 * Esperamos 1 parÃ¢metro (lembrando que o nome do script
 * tambÃ©m conta) com o nome do TXT.
 */
if ($argc &amp;lt; 2) {
  echo &#34;O nome do arquivo TXT deve ser passado para o script.\n&#34;;

  /*
   * Passamos um cÃ³digo de erro (qualquer nÃºmero inteiro
   * entre 1 e 254) para indicar que o programa encerrou com erro.
   */
  exit(1);
}
$file = $argv[1];

/*
 * Verificamos se a extensÃ£o do arquivo Ã© txt.
 */
if (&#34;.txt&#34; !== strtolower(substr($file, -4)) {
  echo &#34;O script aceita somente arquivos TXT.\n&#34;;
  exit(1);
}

// Pegamos o conteÃºdo do arquivo.
$contents = file_get_contents($file);

// Separamos as palavras em um array.
$words = preg_split(&#34;/[\s+,\.!\?\(\):]/&#34;, $contents, null, PREG_SPLIT_NO_EMPTY);

// Ordenamos alfabeticamente.
natcasesort($words);

foreach ($words as $position =&amp;gt; $word) {

  /*
   * Imprimimos cada palavra e sua respectiva posiÃ§Ã£o
   * dentro do texto.
   */
  echo &#34;{$word} ({$position})\n&#34;;

}&lt;/pre&gt;

&lt;p&gt;Feito!&lt;/p&gt;

&lt;p&gt;Agora se criarmos um TXT chamado &lt;strong&gt;sobre.txt&lt;/strong&gt;, no mesmo diretÃ³rio que nosso script, contendo a primeira frase do artigo da WikipÃ©dia sobre o PHP, teremos o resultado abaixo:&lt;/p&gt;

&lt;pre&gt;$ php script.php sobre.txt
acrÃ´nimo (2)
apenas (19)
aplicaÃ§Ãµes (24)
atuantes (27)
capazes (32)
[...]
usada (17)
Web (40)
Wide (39)
World (38)
Ã© (12)&lt;/pre&gt;

&lt;h2 id=&#34;3-mesclando-o-uso-com-outros-comandos&#34;&gt;3. Mesclando o uso com outros comandos&lt;/h2&gt;

&lt;p&gt;Falando um pouco das utilidades que o terminal oferece e que podemos combinar com o nosso script, temos, por exemplo, o &lt;strong&gt;grep&lt;/strong&gt;, que executa buscas atravÃ©s de expressÃµes regulares (alternativamente, no Windows vocÃª pode usar o &lt;strong&gt;findstr&lt;/strong&gt;: &lt;a title=&#34;http://technet.microsoft.com/en-us/library/bb490907.aspx&#34; href=&#34;http://technet.microsoft.com/en-us/library/bb490907.aspx&#34; target=&#34;_blank&#34;&gt;&lt;a href=&#34;http://technet.microsoft.com/en-us/library/bb490907.aspx&#34;&gt;http://technet.microsoft.com/en-us/library/bb490907.aspx&lt;/a&gt;&lt;/a&gt;). Se quisermos filtrar o resultado do nosso script para exibir apenas uma palavra especÃ­fica, sem alterar o cÃ³digo, poderÃ­amos executÃ¡-lo assim:&lt;/p&gt;

&lt;pre&gt;$ php script.php sobre.txt | grep originalmente
originalmente (18)
originalmente (8)&lt;/pre&gt;

&lt;p&gt;O grep Ã© apenas um dos comandos disponÃ­veis que podem ser agregados a execuÃ§Ã£o do seu script, mas a idÃ©ia Ã© apresentar apenas o bÃ¡sico sobre a execuÃ§Ã£o de programas PHP via linha de comando.&lt;/p&gt;

&lt;p&gt;Ficou com alguma dÃºvida? Fique a vontade para usar o espaÃ§o de comentÃ¡rios.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>