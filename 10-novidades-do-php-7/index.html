
<!DOCTYPE html>
<html lang="pt-br" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  <base href="http://tableless.com.br/">
  <title>Tableless</title>
  <link rel="canonical" href="http://tableless.com.br/10-novidades-do-php-7/">
  <link href="" rel="alternate" type="application/rss+xml" title="Tableless" />
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css">
  
</head>
<body>


  <header id="tb-header">
    <a href="http://tableless.com.br/" class="tb-logo"><img src="images/logo.svg"></a>

    

    <nav id="tb-menu">
      <ul>

        
          
              
            <li>
              <a href="/categories/html">
                  
                  HTML
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/css/">
                  
                  CSS
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/javascript/">
                  
                  JavaScript
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/back-end/">
                  
                  Back-end
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/wordpress/">
                  
                  WordPress
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/acessibilidade/">
                  
                  Acessibilidade
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/design/">
                  
                  Design
              </a>
          
            </li>
          
              
            <li>
              <a href="/categories/t%C3%A9cnicas-e-pr%C3%A1ticas/">
                  
                  Na prática
              </a>
          
            </li>
          

      </ul>
    </nav>

  </header>

  <header class="tb-post-header">
    <h1 class="tb-hero-title"><a href="/10-novidades-do-php-7/">10 novidades do PHP 7</a></h1>
  <p class="tb-hero-p">
    
    O PHP 7 deve ser lançado até o final desde ano de 2015. Há muitas novidades. Mostro aqui 10 delas, inclusive a melhoria no desempenho
    
  </p>
      <span class="tb-author">por <a href="/author/roberto-beraldo">Roberto Beraldo</a></span>


  </header>


<section class="tb-post">

  <section class="tb-post-content">
    <article class="tb-post-article">
      

<p>O PHP 7 está prestes a ser lançada oficialmente, até o final deste ano de 2015.</p>

<p>A versão <em>Release Candidate</em> (RC) do PHP 7 foi lançada no dia 21 de agosto. Sendo uma versão RC, não haverá implementações novas no PHP 7.0, apenas correções de bugs.</p>

<p>Vou apresentar aqui algumas novidades e recursos novos desta versão do PHP.</p>

<h2 id="1-desempenho-fantástico">1. Desempenho Fantástico</h2>

<p>O PHP 7 teve seu motor remodelado. Com isso, houve um grande ganho de desempenho.</p>

<p>Em alguns casos, é possível alcançar <a href="http://rberaldo.com.br/php-7-9-vezes-mais-rapido-que-php-5-6/" target="_blank">até 9 vezes mais velocidade</a>. Mas esse número pode variar conforme a plataforma e a aplicação utilizada nos testes.</p>

<p>Eu utilizei o script para benchmark criado pela própria equipe do PHP, disponibilizado junto com o código-fonte da linguagem. Em comparação com a versão 5.6, consegui aproximadamente 9 vezes mais velocidade usando o PHP 7. Expliquei esse teste com mais detalhes <a href="http://rberaldo.com.br/php-7-9-vezes-mais-rapido-que-php-5-6/" target="_blank">neste meu artigo</a>.</p>

<ol>
<li>MySQL Removido</li>
</ol>

<p>Desde o PHP 5.5, <a href="http://PS: funções mysql_* estão obsoletas desde o PHP 5.5  e já foram removidas no PHP 7. Prefira usar MySQLi ou PDO. Veja mais aqui: http://www.ultimatephp.com.br/php-por-que-nao-utilizar-funcoes-mysql" target="_blank">as funções mysql_* eram consideradas obsoletas</a>. Ou seja, tudo indicava que elas seriam removidas em um futuro bem próximo.</p>

<p>Pois bem. A hora chegou.</p>

<p>No PHP 7, as funções mysql_* (como mysql_connect(), mysql_query() e outras) deixaram de existir. Agora é preciso utilizar MySQLi ou PDO.</p>

<p><a href="http://www.ultimatephp.com.br/como-usar-pdo-com-banco-de-dados-mysql/" target="_blank">Recomendo utilizar PDO</a>, por ser mais robusta e ser independente de SGBD.</p>

<ol>
<li>Funções ereg_* Removidas</li>
</ol>

<p>Além das funções mysql_*, as funções ereg_* e eregi_* (como ereg(), ereg_replace, eregi() e outras) eram consideradas obsoletas desde o PHP 5.3.</p>

<p>Elas também foram removidas no PHP 7.</p>

<p>Agora é preciso usar as funções preg_*, da <a href="http://php.net/manual/pt_BR/book.pcre.php" target="_blank">biblioteca PCRE</a>, como preg_match e preg_replace.</p>

<p>As funções preg_* exigem delimitadores. Consequentemente, é possível utilizar <a href="http://php.net/manual/pt_BR/reference.pcre.pattern.modifiers.php" target="_blank">modificadores</a>, como &#8220;i&#8221; e &#8220;u&#8221;. O &#8220;i&#8221;, por exemplo, significa case-insensitive. Ou seja, se você usava eregi_*, passará a usar preg_*, sempre com o modificador &#8220;i&#8221;.</p>

<h2 id="3-erros-fatais-e-exceções">3. Erros Fatais e Exceções</h2>

<p>No PHP 7, erros fatais passaram a ser Exceções. Isso quer dizer que eles podem ser tratados em bloco try/catch, sem interromper a execução do script.</p>

<p>Para exemplificar, vamos executar este código (no PHP 7, não no PHP 5):</p>

<pre class="lang-php">ereg('^[a-z]$', 'php7');
echo "FIM";
</pre>

<p>Veremos este erro:</p>

<pre>Fatal error: Uncaught Error: Call to undefined function ereg()...
</pre>

<p>E o texto &#8220;FIM&#8221; não será exibido. Isso ocorre pois a exceção interrompe o script.</p>

<p>Agora execute este script:</p>

<pre class="lang-php">try
{
    ereg('^[a-z]$', 'php7');
}
catch (Error $e)
{
    echo "Ocorreu um erro: " . $e-&gt;getMessage();
}

echo "FIM";
</pre>

<p>Você verá a seguinte saída:</p>

<pre>Ocorreu um erro: Call to undefined function ereg()
FIM
</pre>

<p>Ou seja, nossa aplicação tratou a exceção e a execução continuou normalmente.</p>

<h2 id="4-construtores-do-php-4-obsoletos">4. Construtores do PHP 4 Obsoletos</h2>

<p>Antes do PHP 5, os construtores recebiam o mesmo nome da classe. Por exemplo:</p>

<pre class="lang-php">class ClassePHP4
{
    function ClassePHP4()
    {
        echo "Construtor chamado";
    }
}
</pre>

<p>Isso continuou funcionando no PHP 5, mas era recomendado usar o método <code>__construct</code>, ficando desta forma:</p>

<pre class="lang-php">class ClassePHP5
{
    public function __construct()
    {
        echo "Construtor chamado";
    }
}
</pre>

<p>O PHP 7 recomenda que seja usado método <code>__construct</code> em vez do método com o mesmo nome da classe. Ou seja, o uso de construtores no padrão do PHP 4 continuará sendo possível, mas é um recurso obsoleto (<em>Deprecated</em>).</p>

<p>Para testar isso, vamos executar este código:</p>

<h2 id="5-indução-de-tipos-scalar-types">5. Indução de Tipos: <em>Scalar Types</em></h2>

<p>PHP é uma linguagem <strong>NÃO</strong> tipada.</p>

<p>Aos poucos ela vem ganhando alguns recursos que a torna fracamente tipada.</p>

<p>Isso significa que podemos criar códigos mais consistentes e menos suscetíveis a erros e problemas.</p>

<p>O PHP 5 já possui o recurso de <a href="http://php.net/manual/pt_BR/language.oop5.typehinting.php" target="_blank">Indução de Tipos</a>.</p>

<p>É possível definir alguns tipos para parâmetros de métodos e funções. Mas só é possível definir dois tipos: arrays (o tipo &#8220;array&#8221;) e objetos (com o nome da classe).</p>

<p>A partir do PHP 7, poderemos usar outros tipos também: int, float, string e bool.</p>

<p>Esses tipos podem ser definidos nos parâmetros de funções e métodos, como já era feito no PHP 5. Mas agora há uma novidade: também poderemos definir o tipo do retorno.</p>

<h2 id="6-tipo-de-retorno-de-funções-e-métodos">6. Tipo de Retorno de Funções e Métodos</h2>

<p>Seguindo a mesma ideia da Indução de Tipos que vimos anteriormente, o PHP 7 vai permitir definir o tipo de retorno de uma função ou método.</p>

<p>Basta seguir esta sintaxe:</p>

<pre class="lang-php">function nomeFuncao() : tipo
{
    // corpo da função
}
</pre>

<p>Por exemplo:</p>

<pre class="lang-php">function soma($x, $y) : float
{
    return $x + $y + 1.5;
}
</pre>

<p>E, claro, pode usar todos os tipos suportados: int, float, string, bool, array e objeto.</p>

<h2 id="7-novo-operador-spaceship">7. Novo Operador <em>Spaceship</em> (<code>&lt;=&gt;</code>)</h2>

<p>Esse operador recebe o nome de &#8220;<em>Spaceship</em>&#8221; em algumas outras linguagens, e é usado para comparação numérica.</p>

<p>Se você já usou a função <code>strcmp()</code>, com certeza vai entender esse operador sem dificuldades.</p>

<p>Mesmo se não usou, é simples de entender.</p>

<p>Veja estes exemplos:</p>

<pre class="lang-php">var_dump(2 &lt;=&gt; 3); // retorna -1
var_dump(2 &lt;=&gt; 2); // retorna 0
var_dump(2 &lt;=&gt; 1); // retorna 1
</pre>

<p>Ou seja, o operador <code>&lt;=&gt;</code> retorna um destes 3 valores:</p>

<p>&#8211; retorna -1 quando o primeiro operando é menor que o segundo</p>

<p>&#8211; retorna 0 quando os dois operandos são iguais</p>

<p>&#8211; retorna 1 quando o segundo operando é maior que o primeiro</p>

<h2 id="9-null-coalesce-operator-operador">9. <em>Null Coalesce Operator</em> (operador <code>??</code>)</h2>

<p>O nome parece complicado, mas ele faz algo bem simples.</p>

<p>Ele é útil para verificar a existência de variáveis, como fazemos com valores de <code>$_GET</code> ou <code>$_POST</code>, usando <code>isset</code>.</p>

<p>Ele faz com que esta linha:</p>

<pre class="lang-php">$email = $_POST['email'] ?? 'valor padrão';
</pre>

<p>&#8230; seja transformada nesta:</p>

<pre class="lang-php">$email = isset($_POST['email']) ? $_POST['email'] : 'valor padrão';
</pre>

<p>Super simples!</p>

<h2 id="10-classes-anônimas">10. Classes Anônimas</h2>

<p>O PHP, a partir da versão 5.4, permite a criação de <a href="http://php.net/manual/pt_BR/functions.anonymous.php" target="_blank">Funções Anônimas</a>. Elas são úteis especialmente para criação de <em>callbacks</em> ou para usar em parâmetros de funções, como <code>array_map()</code>.</p>

<p>A partir do PHP 7, podemos criar Classes Anônimas também.</p>

<p>Podemos, por exemplo, fazer uma função retornar uma classe, definida ns própria expressão <code>return</code>:</p>

<pre class="lang-php">function createObject()
{
    return new class{
        public function test()
        {
            echo "test" . PHP_EOL;
        }
    };
}

$obj = createObject();
$obj-&gt;test();
</pre>

<p>Há outros casos de uso, como em testes de software.</p>

<p>Você pode ver a proposta e alguns casos de uso no <a href="https://wiki.php.net/rfc/anonymous_classes" target="_blank">RFC que descreve esse recurso</a>.</p>

<h2 id="conclusão">Conclusão</h2>

<p>O PHP 7 traz diversas novidades. E, se você seguia as Boas Práticas e padrões que o PHP recomendava, a partir da versão 5.5, provavelmente terá pouquíssimos problemas (ou nenhum) para migrar para o PHP 7.</p>

<p>Se quiser conhecer melhor essas novidades e algumas outras, criei um <a href="http://cursophp7.ultimatephp.com.br" target="_blank">curso gratuito</a>, onde mostro com mais detalhes cada um desses novos recursos. Também mostro como instalar o PHP 7, sem afetar a sua instalação atual do PHP 5.</p>

<p><strong><a href="http://cursophp7.ultimatephp.com.br" target="_blank">Clique aqui e se inscreva no meu curso gratuito do PHP 7</a></strong></p>

<p>Bons estudos e fique de olho no PHP 7!</p>

    </article>

<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = '';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
  </section>


  <aside class="tb-aside">
    Banner
  </aside>

</section>


<footer id="tb-footer">
    <div class="tb-container">
    <ul class="tb-social-links">
        <li><a href="http://facebook.com/tablelessbr">Facebook</a></li>
        <li><a href="http://twitter.com/tableless">Twitter</a></li>
        <li><a href="http://tableless.com.br/feed">RSS</a></li>
        <li><a href="http://medium.com/tableless">Medium</a></li>
    </ul>
    <nav class="tb-footer-nav">
        <a href="">Contato</a>
        <a href="">Anuncie</a>
        <a href="">Seja um Autor</a>
        <a href="">Fazemos código front-end</a>
    </nav>

    <p class="tb-for-community">
        Escrito pela e para a comunidade web brasileira. <a href="">Ajude</a>.
    </p>
    </div>
</footer>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>


<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
<script>
$(document).ready(function() {
  $('pre').each(function(i, block) {
    hljs.highlightBlock(block);
  });
})</script>


</body>
</html>

